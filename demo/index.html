<!DOCTYPE html>
<html>
<head>
    <title>Boruca Messaging Demo</title>
</head>
<body>
<h1>Top Frame</h1>
<iframe src="./iframe.html"></iframe>

<script type="module">
    import Boruca from '../src/boruca.js';

        (async function () {
            const $iframe = document.querySelector('iframe');
            const targetWindow = $iframe.contentWindow;
            const targetOrigin = window.location.origin;

            class TopLevel {
                increase(number) {
                    return number + 1;
                }

                echo(message) {
                    return 'TopLevel Echo: ' + message;
                }
            }

            const { proxy: IFrameProxy } = await Boruca.proxy(targetWindow, targetOrigin, TopLevel);

            console.log(await IFrameProxy.echo("I'm sending this from the top window!"));
            console.log(await IFrameProxy.decrease(100));
        })();
    </script>
</body>
</html>
